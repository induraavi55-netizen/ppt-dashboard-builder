# PPT Layout Contract

> **Version:** 1.0  
> **Date:** 2026-02-03  
> **Enforced by:** `slide_builder.py` and `chart_renderer.py`

This document serves as the **Single Source of Truth** for the visual layout and behavior of the generated PowerPoint dashboards.

## 1. General Slide Layout
- **Title**: Must be placed inside the branded Green Header Bar (Top ~18% of slide).
- **Text Color**: White for Title, Black for Body.
- **Footer**: Every slide must contain a version stamp in the bottom-right corner.
  - Format: `Generated by Dashboard Engine v{version} | {Date}`

## 2. Chart Layout Rules
- **Positioning**: All charts must be **Horizontally Centered** on the slide.
- **Canvas**: Charts are rendered on a white canvas background (if explicitly boxed) or transparent.

### Dimensions (Width x Height in EMU)
| Chart Family | Width Strategy | Height Strategy | Notes |
| :--- | :--- | :--- | :--- |
| **LO (Learning Outcome)** | `920px` (Wide) | Dynamic: `360px + (Rows * 45px)` | Max height clamped at `900px`. Split to new slide if overflow. |
| **QLVL (Question Level)** | `760px` | `440px` | Fixed. |
| **Summary / Subwise** | `760px` | `430px` | Fixed. |
| **Reg vs Part** | `700px` | `420px` | Slightly narrower to maintain aspect ratio. |

## 3. Chart Formatting Rules (Renderer)

### Common Rules
- **Axis Titles**: MUST be present for both X and Y axes.
- **Font Sizes**:
  - Axis Labels: `Pt(10)` to `Pt(12)` depending on chart type.
  - Data Labels: `Pt(9)` minimum for readability.

### Percent-Based Charts
- **Y-Axis**: MUST be fixed from `0` to `100`.
- **Data Labels**: MUST include `%` symbol (e.g., `85%`).

### Specific Chart Families
- **Reg vs Part**: 
  - **Participated Series**: Data labels `OUTSIDE_END` (Black).
  - **Registered Series**: Data labels `INSIDE_END` (White, contrasting).
- **Pie Charts**: 
  - **No Legend**: Legend must be hidden.
  - **Labels**: Category Name + Value + Percentage shown in data labels.

## 4. Debug & QA (When `EXPORT_DEBUG=true`)
- **Slide Builder**: Draws a colored bounding box around the chart area.
- **Chart Renderer**: Renders a text box inside the chart with:
  - Dataset Name
  - Chart Family
  - Axis Scale (Min/Max)
